.PHONY: all server client clean help

all: client server

# Build server (for current platform)
server:
	@echo "ğŸ”§ Building council_server..."
	cd cmd/server && go build -o ../../council_server .
	@echo "âœ… Server binary: council_server"

# Build Linux client (cross-compile for Linux amd64)
client:
	@echo "ğŸ”§ Building council_client_linux..."
	cd cmd/client && GOOS=linux GOARCH=amd64 go build -o ../../council_client_linux .
	@echo "âœ… Client binary: council_client_linux"

# Build client for current platform (for testing)
client-local:
	@echo "ğŸ”§ Building council_client (local)..."
	cd cmd/client && go build -o ../../council_client .
	@echo "âœ… Client binary: council_client"

clean:
	rm -f council_server council_client council_client_linux

# Run server
run-server: server
	./council_server

# Run client (local testing)
run-client: client-local
	./council_client localhost:9000

# Show help
help:
	@echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
	@echo "â•‘  Distributed Council - Build Targets                            â•‘"
	@echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
	@echo "â•‘  make all          - Build both server and client               â•‘"
	@echo "â•‘  make server       - Build server binary                        â•‘"
	@echo "â•‘  make client       - Build Linux client (cross-compile)         â•‘"
	@echo "â•‘  make client-local - Build client for current platform          â•‘"
	@echo "â•‘  make run-server   - Build and run server                       â•‘"
	@echo "â•‘  make run-client   - Build and run client (localhost:9000)      â•‘"
	@echo "â•‘  make clean        - Remove built binaries                      â•‘"
	@echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
	@echo "â•‘  Usage:                                                         â•‘"
	@echo "â•‘  1. Run 'make all' to build both binaries                       â•‘"
	@echo "â•‘  2. Start server: ./council_server                              â•‘"
	@echo "â•‘  3. On remote machines: ./council_client_linux <ip>:9000        â•‘"
	@echo "â•‘  4. Open http://localhost:8080 and click 'Start'                â•‘"
	@echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
